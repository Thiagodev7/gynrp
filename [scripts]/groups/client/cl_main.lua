-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
local Proxy  = module("vrp","lib/Proxy")
local config = module(GetCurrentResourceName(), "config")
vRP = Proxy.getInterface("vRP")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONEX√ÉO
-----------------------------------------------------------------------------------------------------------------------------------------
psRP = {}
Tunnel.bindInterface("groups",psRP)
vSERVER = Tunnel.getInterface("groups")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIABLES
-----------------------------------------------------------------------------------------------------------------------------------------
local menuEnabled = false
-----------------------------------------------------------------------------------------------------------------------------------------
-- ToggleActionMenu
-----------------------------------------------------------------------------------------------------------------------------------------
function ToggleActionMenu()
    local check, config = vSERVER.getConfig()
    if check then
        menuEnabled = not menuEnabled
        if menuEnabled then
            SetNuiFocus(true,true)

            SendNUIMessage({ loadconfig = true, config = config })
            SendNUIMessage({ showmenu = true })

            TransitionToBlurred(1000)
        else
            SetNuiFocus(false,false)
            SendNUIMessage({ hidemenu = true })
            TransitionFromBlurred(1000)
        end
    end
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- close
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("close", function(data, cb)
    ToggleActionMenu()
    cb(true)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- RegisterCommand
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterCommand(config.command, function(source, args, rawCommand)
    ToggleActionMenu()
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- RegisterCommand
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterKeyMapping(config.command,"Abrir tablet grupos","keyboard", config.keybind)
-----------------------------------------------------------------------------------------------------------------------------------------
-- getconfig
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("getconfig", function(data, cb)
    local check,ndata = vSERVER.getConfig()
    local data = {}

    if check then
        data = ndata
    end

    cb(data)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- searchuser
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("searchuser", function(data, cb)
	local row = vSERVER.searchUser(data)
    cb(row)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- addusergroup
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("addusergroup", function(data, cb)
	local check = vSERVER.addUserGroup(data)
    cb(check)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- remusergroup
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("remusergroup", function(data, cb)
	local check = vSERVER.remUserGroup(data)
    cb(check)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- editusergroup
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("editusergroup", function(data, cb)
	local check = vSERVER.editUserGroup(data)
    cb(check)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- getorgchestlogs
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("getorgchestlogs", function(data, cb)
	local row = vSERVER.getOrgChestLogs(data)
    cb(row)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- getorgbanklogs
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("getorgbanklogs", function(data, cb)
	local row = vSERVER.getOrgBankLogs(data)
    cb(row)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- addorgbank
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("addorgbank", function(data, cb)
	local check = vSERVER.addOrgBank(data)
    cb(check)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- remorgbank
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("remorgbank", function(data, cb)
	local check = vSERVER.remOrgBank(data)
    cb(check)
end)